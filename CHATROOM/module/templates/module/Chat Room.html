{% extends 'base.html' %}

{% block title %}
    Chat Room
{% endblock %}

{% block content %}

<meta name="csrf-token" content="{{ csrf_token }}">

<h2 class="text-info">Chat Box</h2>

<div class="border border-info rounded p-2 overflow-auto text-info" id="border" style="height: 400px;">
    {% for mes in message %}
        <div class="d-flex m-3 bg-secondary text-light rounded p-3">
            <div class="me-2">
                <img id="image" class="rounded" src="{% if mes.user.avatar %}{{ mes.user.avatar.url }}{% endif %}" alt="no image" style="width: 50px; height: 50px;">
            </div>
            <div class="d-flex flex-column">
                <h5>
                    {% if mes.user.first_name %}
                        {{ mes.user.first_name }}
                    {% else %}
                        {{ mes.user.username }}
                    {% endif %}
                    <small>{{ mes.timestamp|date:"g:i A" }}</small>
                </h5>

                {% if mes.content %}
                    <p class="text-break fw-bold">{{ mes.content }}</p>
                {% endif %}

                {% if mes.image %}
                    <img src="{{ mes.image.url }}" class="img-fluid rounded mt-2" style="max-width: 200px;">
                {% endif %}

                {% if mes.audio %}
                    <audio controls class="mt-2" style="width: 100%;">
                        <source src="{{ mes.audio.url }}">
                        Your browser does not support the audio element.
                    </audio>
                {% endif %}
            </div>
        </div>
    {% endfor %}
</div>

<fieldset class="form-group mt-4">
    <div class="input-group">
        <div class="input-group-prepend" id="button-addon3">
            <button class="btn btn-outline-info" type="button" onclick="sendmessages()">Send</button>
        </div>
        <input type="text" class="form-control bg-dark border-info text-info" placeholder="message..." aria-describedby="button-addon3" id="messagetext">
    </div>
    <input type="file" class="form-control mt-2 bg-dark border-info text-info" id="messagefile" accept="image/*,audio/*">
</fieldset>
{% endblock %}
